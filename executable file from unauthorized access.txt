#include<io.h>
#include<fcntl.h>
#include<process.h>
#include<share.h>
#include<stdio.h>
#include<locking.h>
#include<conio.h>
int main (void)
  {
  int handle,status;
   long length;
   clrscr();
   handle=open("z.txt",O_RDONLY,SH_DENYNO);
   if(handle<0){
      printf("sopen failed\n");
      exit(1);
   }
    length=filelength(handle);
    status=locking(handle,LK_LOCK,length/2);
    if(status==0)
       printf("lock succeded\n");
     else
        perror("lock failed");
/*
 status=locking(handle,LK_UNLOCK,length/2);
    if(status==0)
       printf("unlock succeded\n");
     else
        perror("unlock failed");
*/
    close(handle);
    getch();
   return 0;
}